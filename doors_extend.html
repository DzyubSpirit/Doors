<html>
<head>
  <meta charset="utf-8" />
    <script>
window.onload = function() {
  function Door(color, shape, pos, text, rule) {
    this.color = color;
    this.shape = shape;
    this.pos = pos;
    this.text = text;
    this.rule = rule;
  }
  
  function roomRule(truthfullMin, truthfullMax, toDzyubablePos) {
    return function(doors, choosenDoorPos) {
      var truthfullCount = doors.filter(function(elem) { 
	return elem.truthfull;
      }).length;
      return truthfullCount >= truthfullMin && truthfullCount <= truthfullMax;
       // && choosenDoorPos === toDzyubablePos;
        
    };
  };

  var doors = [];
  doors.push(new Door('Синяя', null, 0, 'Желтая дверь ведет к Дзюбе<br/>Либо желтая, либо красная дверь правильная',
	function(doors, rightDoor) {
          /*var statement2 = doors[2].truthfull || doors[1].truthfull;
          var statement1 = rightDoor === 2;
          if (statement1 ^ statement2) {
            return false;
          }
          return this.truthfull? statement1 : !statement1;*/
	  return this.truthfull ^ (!doors[2].truthfull);
        }));
  doors.push(new Door('Красная', null, 1, 'Ты не выберешь эту дверь',
        function(doors, rightDoor) {
          return this.truthfull ? rightDoor !== 1 : rightDoor === 1;
        }));
  
  doors.push(new Door('Желтая', null, 2, 'Ты выберешь синюю дверь',
        function(doors, rightDoor) {
          return this.truthfull ? rightDoor === 0 : rightDoor !== 0;
        }));
  
  var rightDoorPos = 1;

  var mainRule = roomRule(0, 1, 1);  
  
  checkRules(mainRule, doors);  

  renderDoors(doors);

  function checkRules(roomRule, doors) { 
    var rightCount = 0;
    var rightAnswers = [];
    for (var doorTruth = 0; doorTruth < Math.pow(2, doors.length); doorTruth++) {
      for (var i = 0; i < doors.length; i++) {
        doors[i].truthfull = !!(doorTruth & (1<<i));
      }
      for (var rightDoor = 0; rightDoor < doors.length; rightDoor++) {
        if (!roomRule(doors, rightDoor)) {
          continue;
        }
        var pr = false;
        for (var i = 0; i < doors.length; i++) {
          if (!doors[i].rule(doors, rightDoor)) {
            pr = true;
            break;
          }
        }
        if (pr) {
          continue;
        }
        rightCount++;
        rightAnswers.push({
          truthfulls: doorTruth,
          rightDoor: rightDoor
        });
         
      }
    }
    console.log(rightCount);
    console.log(rightAnswers);
  }

  function renderDoors(doors) {
    var doorsElem = document.getElementById('doors');
    for (var i in doors) {
      var door = doors[i];
      var doorElem = document.createElement('div');
      var innerHTML = 'Color: ' + door.color;
      innerHTML += door.shape ? '<br/>Shape: '+door.shape: '';
      innerHTML += '<hr/>'+door.text;
      innerHTML += '<hr/>';
      doorElem.innerHTML = innerHTML;
      var button = document.createElement('button');
      button.innerHTML = 'Choose';
      button.onclick = (function(door) {
        return function() {
	  if (door.pos === rightDoorPos) {
            alert('Ebat ti umniy');
          } else {
            alert('Ha loh!');
          }
        };
      })(door);
      doorElem.appendChild(button);      
      doorsElem.appendChild(doorElem);
    }
  }  
}
  </script>
  <style>
    #doors {
      display: flex;
    }

    #doors div {
      border: 1px solid black;
      padding: 2px;
      margin: 5px;
      width: 150px;
    }
  </style>
</head>
<body>
  <p> 1 или 0 дверей правильные </p>
  <div id="doors">
    
  </div> 
</body>
</html>